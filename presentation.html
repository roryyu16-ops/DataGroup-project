<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Heart Disease Mortality in the Scotland</title>
    <meta charset="utf-8" />
    <meta name="author" content="Artery Party   Roderick Yu, Yufei Xiang, Hoddy Zhu, Lincoln Luk" />
    <meta name="date" content="2025-11-30" />
    <script src="libs/header-attrs-2.29/header-attrs.js"></script>
    <script src="libs/kePrint-0.0.1/kePrint.js"></script>
    <link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
    <link rel="stylesheet" href="xaringan-themer.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

.title[
# Heart Disease Mortality in the Scotland
]
.author[
### Artery Party <br> Roderick Yu, Yufei Xiang, Hoddy Zhu, Lincoln Luk
]
.institute[
### University of Edinburgh
]
.date[
### 2025-11-30
]

---

















class: inverse, center, middle

# Research Question

---

class: center, middle

# Research Question

&lt;span style="font-size: 1.4em; font-weight: bold;"&gt; How do heart disease mortality rates vary across Scotland, and which factors are more important? &lt;/span&gt;

# Aim

&lt;span style="font-size: 1.4em; font-weight: bold;"&gt; to use predictive modelling to provide risk predictions for the Scottish population &lt;/span&gt;


---

class: inverse, center, middle

# How do we clean the data?

---
# How do we clean the data?

.pull-left[

- Select key variables. 
- Remove NA values.


```
## # A tibble: 7,230 × 3
##    AgeGroup     Sex     Diagnosis             
##    &lt;chr&gt;        &lt;chr&gt;   &lt;chr&gt;                 
##  1 0-44 years   Males   Coronary Heart Disease
##  2 0-44 years   Females Coronary Heart Disease
##  3 45-64 years  Males   Coronary Heart Disease
##  4 45-64 years  Females Coronary Heart Disease
##  5 65-74 years  Males   Coronary Heart Disease
##  6 65-74 years  Females Coronary Heart Disease
##  7 75plus years Males   Coronary Heart Disease
##  8 75plus years Females Coronary Heart Disease
##  9 0-44 years   Males   Coronary Heart Disease
## 10 0-44 years   Females Coronary Heart Disease
## # ℹ 7,220 more rows
```


]

.pull-right[
&lt;span style="font-size: 1.4em; font-weight: bold;"&gt; Data Overview: &lt;/span&gt;
&lt;table class="table" style="width: auto !important; "&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; Variable &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Description &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Type &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Year &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Year of recorded data &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Numeric &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; CA &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Council area code &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Categorical &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; AgeGroup &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Defined age range &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Categorical &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Sex &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Male or female &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Categorical &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Diagnosis &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Specific heart-disease-related diagnosis &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Categorical &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; CrudeRate &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Raw mortality rate &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Numeric &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; EASR &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; European Age-Standardised Rate &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Numeric &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
]


---
class: inverse, center, middle

&lt;style&gt;
.my-style .pull-left { 
  float: left;
  width: 15%;
  margin-left: 35%;
}

.my-style .pull-right {
  float: right;
  width: 15%;
  margin-right: 35%;
}
&lt;/style&gt;


# Crude Mortality by Six Factors


&lt;div class="my-style"&gt;
.pull-left[
- EASR  
- Gender  
- Age Group  
]

.pull-right[
&lt;p style="margin: 0; padding: 0; text-align: left;"&gt;
- Diagnosis
- Year
- Region  
]
&lt;/div&gt;

---

# EASR

&lt;img src="presentation_files/figure-html/unnamed-chunk-4-1.png" width="75%" style="display: block; margin: auto;" /&gt;


---

# Gender

&lt;img src="presentation_files/figure-html/unnamed-chunk-5-1.png" width="75%" style="display: block; margin: auto;" /&gt;


---

# Age Group

&lt;img src="presentation_files/figure-html/unnamed-chunk-6-1.png" width="75%" style="display: block; margin: auto;" /&gt;



---

# Diagnosis

&lt;img src="presentation_files/figure-html/unnamed-chunk-7-1.png" width="75%" style="display: block; margin: auto;" /&gt;


---

# Year

&lt;img src="presentation_files/figure-html/unnamed-chunk-8-1.png" width="75%" style="display: block; margin: auto;" /&gt;




---

# Regions



&lt;img src="presentation_files/figure-html/unnamed-chunk-10-1.png" width="75%" style="display: block; margin: auto;" /&gt;


---

class: inverse, center, middle

# Crude Mortality by Chart of two variables

---
class: center, middle

.pull-left[

&lt;span style="font-size: 1.4em; font-weight: bold;"&gt; Agegroup and Diagnosis &lt;/span&gt;

&lt;img src="presentation_files/figure-html/unnamed-chunk-11-1.png" width="130%" style="display: block; margin: auto;" /&gt;
]


.pull-right[


&lt;span style="font-size: 1.4em; font-weight: bold;"&gt; Sex and Diagnosis &lt;/span&gt;

&lt;img src="presentation_files/figure-html/unnamed-chunk-12-1.png" width="130%" style="display: block; margin: auto;" /&gt;
]
---


class: inverse, center, middle

# Model building

---

class: inverse, center, middle

# Linear regression model

---

# Set up

--

```
## # A tibble: 6 × 5
##   term                            estimate std.error statistic   p.value
##   &lt;chr&gt;                              &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
## 1 (Intercept)                      293.     1008.        0.290 7.71e-  1
## 2 Year                              -0.152     0.500    -0.304 7.61e-  1
## 3 split_AgeGroup75plus years       269.        7.40     36.3   1.26e-240
## 4 SexMales                          10.1       2.86      3.52  4.37e-  4
## 5 DiagnosisCoronary Heart Disease   66.1       4.31     15.3   3.82e- 51
## 6 DiagnosisHeart Attack             28.6       3.74      7.65  2.58e- 14
```


--
- Year &lt; Is Male &lt; Is Heart Attack &lt; Is Coronary Heart Disease &lt; Is Age 75+

---
# Residual plot 

&lt;img src="presentation_files/figure-html/unnamed-chunk-14-1.png" width="45%" style="display: block; margin: auto;" /&gt;

--
- Clustered residuals with a large empty gap  
Most groups have low crude mortality rates；Only specific groups (e.g., 75+ or certain diagnoses) have very high mortality. Hence,this creates natural gaps in the distribution, independent of the mode  

--
- Fan-shaped pattern  
i. Missing important predictors  
ii. Non-linear relationships that the linear model cannot capture  
iii. The limitations of simple transformations  

---
# log ( CrudeRate + 1 )



&lt;img src="presentation_files/figure-html/unnamed-chunk-16-1.png" width="75%" style="display: block; margin: auto;" /&gt;


---

class: inverse, center, middle

# Adjusted R²


---

---
#Adjusted R²

```
## [1] 0.3448354
```

---
# Scatter Plot: CrudeRate vs Year




&lt;img src="presentation_files/figure-html/unnamed-chunk-19-1.png" width="75%" style="display: block; margin: auto;" /&gt;

---
# Brief summary

Although the linear regression model has limitations, it successfully identifies three key factors that may influence heart disease mortality:  

i. Age group (especially 75+)  

ii. Sex (male)  

iii. Diagnosis type (Coronary Heart Disease, Heart Attack)  

---

class: inverse, center, middle

# Logistic regression model

---

# Logistic regression model

--
&lt;span style="font-size: 1.4em; font-weight: bold;"&gt; Aim: &lt;/span&gt;

- To develop and evaluate a logistic regression model that predicts high/low crude-rate risk from age group, sex and diagnosis.  


--
&lt;span style="font-size: 1.4em; font-weight: bold;"&gt; Data: &lt;/span&gt;

- X = Age + Sex + Diagnosis  

- Y= Rate -&gt; 0,1 because aim to classify high/low risk  

- train / test data set (randomly 80% / 20%)  


--
&lt;span style="font-size: 1.4em; font-weight: bold;"&gt; Model: &lt;/span&gt;

- GLM (Generalized Linear Model) -&gt; model train and model test  

---

# Logistic regression model

--
&lt;img src="presentation_files/figure-html/unnamed-chunk-20-1.png" width="75%" style="display: block; margin: auto;" /&gt;

```
## # A tibble: 1 × 3
##   .metric .estimator .estimate
##   &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;
## 1 roc_auc binary         0.842
```
---
#AUC

--

```
## # A tibble: 1 × 3
##   .metric .estimator .estimate
##   &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;
## 1 roc_auc binary         0.842
```


---
#Sensitivity and specificity

--
.pull-left[
&lt;span style="font-size: 1.4em; font-weight: bold;"&gt;  cutoff = 0.25 &lt;/span&gt;
- Sensitivity = 30 / ( 30 + 20 ) ≈ 0.60
- Specificity = 534 / ( 534 + 32 ) ≈ 0.943   
]
.pull-right[

|                        | high_CrudeRate| low_CrudeRate|
|:-----------------------|--------------:|-------------:|
|labelled high-CrudeRate |             30|            32|
|labelled low-CrudeRate  |             20|           534|
]


--
.pull-left[
&lt;span style="font-size: 1.4em; font-weight: bold;"&gt;  cutoff = 0.5 &lt;/span&gt;
- Sensitivity = 24 / ( 24 + 26 ) ≈ 0.48
- Specificity = 553 / ( 553 + 26 ) ≈ 0.977  
]
.pull-right[

|                        | high_CrudeRate| low_CrudeRate|
|:-----------------------|--------------:|-------------:|
|labelled high-CrudeRate |             24|            13|
|labelled low-CrudeRate  |             26|           553|
]

--
.pull-left[
&lt;span style="font-size: 1.4em; font-weight: bold;"&gt; cutoff = 0.75 &lt;/span&gt;
- Sensitivity = 9 / ( 9 + 41 ) ≈ 0.18
- Specificity = NA
]
.pull-right[

|                        | high_CrudeRate| low_CrudeRate|
|:-----------------------|--------------:|-------------:|
|labelled high-CrudeRate |              9|            NA|
|labelled low-CrudeRate  |             41|           566|
]

---

class: inverse, center, middle

# Conclusion

---

# Biases:

&lt;span style="font-size: 1.4em; font-weight: bold;"&gt; Gender: &lt;/span&gt;
Heart disease may be influenced by behaviors such as smoking rate and alcohol consumption.
The model may attribute these hidden effects to gender itself, thus exaggerating gender differences.

&lt;span style="font-size: 1.4em; font-weight: bold;"&gt; Time: &lt;/span&gt;
Certain infectious diseases in some years, such as COVID-19, may also cause abnormal mortality rates.

&lt;span style="font-size: 1.4em; font-weight: bold;"&gt; Dataset selection: &lt;/span&gt;
A single dataset may be affected by multiple factors (such as collection methods), leading to unrealistic results

(for example: many regions have a mortality rate of 0).

---
&lt;span style="font-size: 1.4em; font-weight: bold;"&gt; Limitations: &lt;/span&gt;

Insufficient explanatory variables:  
The data lacks important factors such as health behaviors, lifestyle, and economic conditions,which makes the model unable to properly explain the differences in mortality rate.

The threshold for risk classification may affect results:  
Different thresholds may produce different conclusions.

Structural gaps in the data itself:   
The distribution between high-mortality and low-mortality groups is very unbalanced,causing clustering patterns in the residual plot

&lt;span style="font-size: 1.4em; font-weight: bold;"&gt; Future Improvements: &lt;/span&gt;

Data selection:
- Add more explanatory variables (such as regional economic level, disease behavior risk, hospital resources)
- Expand the sample range (e.g.include longer time span)
Data processing:
-	linear regression model--Try more complex transformations
-	Logistic regression model--Optimize the high/low risk classification method (e.g.quartile)
-	Control the influence of external events (e.g., stratify by COVID years before analysis)
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
  "ratio": "16:9",
  "highlightStyle": "github",
  "highlightLines": true,
  "countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
